# WorkServiceTest 단위 테스트 결과

---

## 목차

1. 작성 정보
2. 테스트 대상 기능
    - 결재 권한 체크
    - 결재라인 설정
    - 업무 관련 기능
    - 결재 작업
3. 테스트 항목
4. 추후 추가 예정 기능

---

## 1. 작성 정보

- **작성일시**: 2025-05-03
- **작성시간**: 20:00
- **작성자**: 장성환
- **테스트 진행자**: 장성환

### 1-1. WorkService

- `WorkService` 클래스는 결재 문서 생성 및 결재 흐름을 담당하는 서비스입니다.
- 이 문서는 해당 클래스에 대한 단위 테스트 항목과 결과, 테스트 대상 기능을 정리한 문서입니다.

---

## 2. 테스트 대상 기능

### 2.1 결재 권한 체크

- **higherThanPrior**  
  이전 결재자보다 직급이 높은지 확인하는 메서드입니다.
    - 직급코드가 높을수록 상위 직급입니다.
    - **매개변수**: 이전 결재자의 직급코드(prior), 현재 결재자의 직급코드(staff)
    - **반환 타입**: boolean

- **isProxy**  
  결재자가 대결 혹은 전대결자인지 확인합니다.
    - **매개변수**: `ApprovalState` 타입 변수
    - **반환 타입**: boolean

- **hasApprovalAuthority**  
  일반적인 결재 원칙에 따라 결재 권한이 있는지를 판단합니다.
    - **매개변수**: 이전 결재자의 직급(prior), 결재선 직급(approval), 현재 결재자 직급(staff), 결재 상태(state)
    - **반환 타입**: boolean

- **hasDirectorProxyAuthority**  
  임원진(상무이사, 부사장, 사장)이 기안한 문서에 대해 대결 권한이 있는지를 판단합니다.
    - **매개변수**: 기안서(work), 결재 상태(approvalState)
    - **반환 타입**: boolean

- **checkApprovalAuthority**  
  최종적으로 결재 권한이 있는지를 종합적으로 판단합니다.
    - **매개변수**: 기안서(work), 결재자(approvalStaff), 결재 상태(approvalState)
    - **반환 타입**: boolean

---

### 2.2 결재라인 설정

- **makeDefaultApprovalLine**  
  기본 결재 라인을 설정합니다.
    - 직급 체계를 기준으로 자동 설정됩니다.
    - **매개변수**: 업무 유형(workType), 기안자(draftStaff)
    - **반환 타입**: ApprovalLine

- **makeApprovalLine** *(도입 예정)*  
  사용자가 직접 결재 라인을 설정하는 기능입니다.
    - **매개변수**: 결재 직급 리스트(approvalPositions)
    - **반환 타입**: ApprovalLine

- **setArbitraryApprovalLine** *(도입 예정)*  
  특정 업무에 대해 전결 권한을 부여하는 기능입니다.
    - **매개변수**: 업무 유형(workType), 전결 권한 부여 대상 직위(arbitraryPosition)
    - **반환 타입**: 업무 유형(workType)

---

### 2.3 업무 관련 기능

- **initiateWork**  
  문서를 생성하는 초기 메서드입니다.
    - **매개변수**: 업무 유형, 기안자, 제목, 보유 연한, 보안 등급, 결재 라인
    - **반환 타입**: 문서(work)

- **createWork**  
  문서 생성 가능 여부를 판단하고 실제 문서를 생성합니다.
    - **매개변수**: 업무 유형, 기안자, 제목, 보유 연한, 보안 등급
    - *오버로딩 버전*: 결재 직급도 함께 받아 makeApprovalLine을 활용하여 생성 *(기능만 구현됨)*
    - **반환 타입**: 문서(work)

- **updateWork**  
  문서 내용을 수정합니다.
    - 단, 결재가 진행 중이거나 완료된 문서는 수정할 수 없습니다.
    - **매개변수**: 제목, 보유 연한, 보안 등급
    - **반환 타입**: 문서(work)

---

### 2.4 결재 작업

- **approvalWork**  
  결재 작업을 수행하는 메서드입니다.
    - **매개변수**: 문서(work), 결재자(approvalStaff), 결재 상태(approvalState)
    - **세부 유형**:
        - `approveWork`: 결재
        - `deferWork`: 보류
        - `rejectWork`: 반려
        - `arbitraryWork`: 전결
        - `proxyWork`: 대결
        - `arbitraryProxyWork`: 전대결

---

## 3. 테스트 항목

| 테스트 항목 | 테스트케이스 수 | 성공 | 실패 |
|-------------|------------------|------|------|
| 기본 결재라인 생성 확인 | 8 | 8 | 0 |
| 기안서 작성 테스트 | 1 | 1 | 0 |
| 기안서 수정 테스트 | 1 | 1 | 0 |
| 1차 결재 권한 확인 및 결재 | 14 | 14 | 0 |
| 2차 결재 권한 확인 및 결재 | 17 | 17 | 0 |
| 3차 결재 권한 확인 및 결재 | 7 | 7 | 0 |
| 4차 결재 권한 확인 및 결재 | 5 | 5 | 0 |

- 비고 : 4차 결재는 사원, 주임, 대리 직급 한정으로 진행

---

## 4. 추후 추가 예정 기능

1. 결재 시 예외 상황 처리 로직
    - 예: 부장이 부재 시 임원진이 자동 대결하는 프로토콜
2. 기안자가 직접 결재라인을 설정하는 기능
    - `makeApprovalLine` 실제 적용
3. 특정 직급에 전결 권한을 부여하는 기능
    - `setArbitraryApprovalLine`과 전대결 관련 기능 구현  

---